<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Register</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-secondary text-white p-3">
<nav class="navbar navbar-expand-lg bg-dark navbar-dark">
    <div class="container-fluid">
        <a class="navbar-brand" href="#">Database</a>
    </div>
</nav>
<div class="container mt-5">
    <h2 class="text-center">Register</h2>
    <form id="register-form" class="mt-4">
        <div class="mb-3">
            <label for="username" class="form-label">Email address</label>
            <input type="email" class="form-control" id="username" required>
        </div>
        <div class="mb-3">
            <label for="password" class="form-label">Password</label>
            <input type="password" class="form-control" id="password" required>
        </div>
        <div class="mb-3">
            <label for="confirm" class="form-label">Confirm Password</label>
            <input type="password" class="form-control" id="confirm" required>
        </div>
        <p class="form-text text-white">Must be 8-20 characters long.</p>
        <div class="d-grid mt-3">
            <button type="submit" class="btn btn-success text-black">Register</button>
        </div>
    </form>
    <p id="msg" class="mt-3"></p>
    <p class="form-text mt-3">
        Already have an account?
        <a href="/" class="btn btn-warning btn-sm text-black">Login</a>
    </p>
</div>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        const form = document.getElementById("register-form");
        const msg = document.getElementById("msg");
        form.addEventListener("submit", async function (e) {
            e.preventDefault();
            msg.textContent = "";
            const username = document.getElementById("username").value.trim();
            const password = document.getElementById("password").value;
            const confirm = document.getElementById("confirm").value;
            if (!username || !password || !confirm) {
                msg.textContent = "Please fill all fields.";
                return;
            }
            if (password.length < 8) {
                msg.textContent = "Password must be at least 8 characters.";
                return;
            }
            if (password !== confirm) {
                msg.textContent = "Passwords do not match.";
                return;
            }
            const response = await fetch("/register-user", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ username, password, confirm })
            });
            const data = await response.json();
            msg.textContent = data.message;
            if (data.success) {
                msg.style.color = "green";
                setTimeout(()=> window.location.href = "/",1000);
            } else{
                msg.style.color = "red";
            }
        });
    });
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>